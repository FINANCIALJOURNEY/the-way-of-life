<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>NFC Game</title>
  <link rel="stylesheet" href="styles.css" />
  <script type="module" src="firebase.js"></script>
</head>
<body>
  <h1>NFC Game</h1>
  <button id="scanBtn">Tap NFC to Join Game</button>
  <button id="simulateBtn">Simulate NFC</button>
  <div id="player"></div>

  <script>
    // Pastikan script jalan lepas page siap
    window.addEventListener("DOMContentLoaded", () => {
      const scanBtn = document.getElementById('scanBtn');
      const simulateBtn = document.getElementById('simulateBtn');
      const playerDiv = document.getElementById('player');

      // Butang NFC sebenar
      scanBtn.addEventListener('click', async () => {
        if ('NDEFReader' in window) {
          try {
            const reader = new NDEFReader();
            await reader.scan();
            reader.onreading = (event) => {
              const decoder = new TextDecoder();
              for (const record of event.message.records) {
                const playerName = decoder.decode(record.data);
                playerDiv.innerText = "Welcome, " + playerName;
                savePlayer(playerName);
              }
            };
          } catch (error) {
            console.error(error);
            alert("Error: " + error);
          }
        } else {
          alert("NFC not supported on this device/browser.");
        }
      });

      // Butang simulate (guna bila tak ada NFC)
      simulateBtn.addEventListener('click', () => {
        const fakeName = "Player" + Math.floor(Math.random() * 100);
        playerDiv.innerText = "Welcome, " + fakeName;
        savePlayer(fakeName);
      });

      // Dummy save function
      function savePlayer(name) {
        console.log("Saving player:", name);
      }
    });
  </script>
</body>
</html>

